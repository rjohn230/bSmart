import { Injectable, Component, Input, Output, EventEmitter, NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var PlaidLinkHandler = /** @class */ (function () {
    /**
     * Constructor configures the Plaid Link handler with given config options.
     * @param PlaidConfig config
     */
    function PlaidLinkHandler(config) {
        this.plaidLink = Plaid.create(config);
    }
    /**
     * Open the Plaid Link window for this handler.
     * @param {?=} institution
     * @return {?}
     */
    PlaidLinkHandler.prototype.open = /**
     * Open the Plaid Link window for this handler.
     * @param {?=} institution
     * @return {?}
     */
    function (institution) {
        this.plaidLink.open(institution);
    };
    /**
     * Closes the currently open Plaid Link window if any.
     * @return {?}
     */
    PlaidLinkHandler.prototype.exit = /**
     * Closes the currently open Plaid Link window if any.
     * @return {?}
     */
    function () {
        this.plaidLink.exit();
    };
    return PlaidLinkHandler;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var NgxPlaidLinkService = /** @class */ (function () {
    function NgxPlaidLinkService() {
    }
    /**
     * Create a Plaid Link instance as soon as Plaid Link has loaded.
     * @param {?} config
     * @return {?} Promise<PlaidLinkHandler>
     */
    NgxPlaidLinkService.prototype.createPlaid = /**
     * Create a Plaid Link instance as soon as Plaid Link has loaded.
     * @param {?} config
     * @return {?} Promise<PlaidLinkHandler>
     */
    function (config) {
        return this.loadPlaid().then(function () {
            return new PlaidLinkHandler(config);
        });
    };
    /**
     * Load or wait for the Plaid Link library to load.
     * @return {?} Promise<void>
     */
    NgxPlaidLinkService.prototype.loadPlaid = /**
     * Load or wait for the Plaid Link library to load.
     * @return {?} Promise<void>
     */
    function () {
        if (!this.loaded) {
            this.loaded = new Promise(function (resolve, reject) {
                /** @type {?} */
                var script = document.createElement('script');
                script.type = 'text/javascript';
                script.src = 'https://cdn.plaid.com/link/v2/stable/link-initialize.js';
                script.onerror = function (e) { return reject(e); };
                if (script.readyState) {
                    script.onreadystatechange = function () {
                        if (script.readyState === 'loaded' || script.readyState === 'complete') {
                            script.onreadystatechange = null;
                            resolve();
                        }
                    };
                }
                else {
                    script.onload = function () {
                        resolve();
                    };
                }
                document.getElementsByTagName('body')[0].appendChild(script);
            });
        }
        return this.loaded;
    };
    NgxPlaidLinkService.decorators = [
        { type: Injectable },
    ];
    /** @nocollapse */
    NgxPlaidLinkService.ctorParameters = function () { return []; };
    return NgxPlaidLinkService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
/**
 * @return {?}
 */
function getWindow() {
    return window;
}
var NgxPlaidLinkButtonComponent = /** @class */ (function () {
    function NgxPlaidLinkButtonComponent(plaidLinkLoader) {
        this.plaidLinkLoader = plaidLinkLoader;
        this.defaultProps = {
            apiVersion: 'v2',
            env: 'sandbox',
            institution: null,
            token: null,
            style: {
                'background-color': '#0085e4',
                'transition-duration': '350ms',
                'transition-property': 'background-color, box-shadow',
                'transition-timing-function': 'ease-in-out',
                '-webkit-appearance': 'button',
                'border': '0',
                'border-radius': '4px',
                'box-shadow': '0 2px 4px 0 rgba(0,0,0,0.1), inset 0 1px 0 0 rgba(255,255,255,0.1)',
                'color': '#fff',
                'font-size': '20px',
                'height': '56px',
                'outline': '0',
                'text-align': 'center',
                'text-transform': 'none',
                'padding': '0 2em',
                'cursor': 'pointer'
            },
            buttonText: 'Log In To Your Bank Account',
            webhook: '',
            product: ['auth'],
            className: 'plaid-link-button'
        };
        this.apiVersion = this.defaultProps.apiVersion;
        this.env = this.defaultProps.env;
        this.institution = this.defaultProps.institution;
        this.product = this.defaultProps.product;
        this.token = this.defaultProps.token;
        this.webhook = this.defaultProps.webhook;
        this.style = this.defaultProps.style;
        this.className = this.defaultProps.className;
        this.buttonText = this.defaultProps.buttonText;
        this.Event = new EventEmitter();
        this.Click = new EventEmitter();
        this.Load = new EventEmitter();
        this.Exit = new EventEmitter();
        this.Success = new EventEmitter();
        this.disabledButton = true;
    }
    Object.defineProperty(NgxPlaidLinkButtonComponent.prototype, "nativeWindow", {
        get: /**
         * @return {?}
         */
        function () {
            return getWindow();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    NgxPlaidLinkButtonComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var self = this;
        this.plaidLinkLoader.createPlaid({
            env: self.env,
            key: self.publicKey,
            product: self.product,
            apiVersion: 'v2',
            clientName: self.clientName,
            onSuccess: function (public_token, metadata) {
                self.onSuccess(public_token, metadata);
            },
            onExit: function (err, metadata) {
                self.onExit(err, metadata);
            },
            onEvent: function (eventName, metadata) {
                self.onEvent(eventName, metadata);
            },
            onLoad: function () {
                self.onLoad();
            },
            token: self.token || null,
            webhook: self.webhook || null
        }).then(function (handler) {
            _this.disabledButton = false;
            _this.plaidLinkHandler = handler;
        });
    };
    /**
     * @return {?}
     */
    NgxPlaidLinkButtonComponent.prototype.onScriptError = /**
     * @return {?}
     */
    function () {
        console.error('There was an issue loading the link-initialize.js script');
    };
    /**
     * @param {?} error
     * @param {?} metadata
     * @return {?}
     */
    NgxPlaidLinkButtonComponent.prototype.onExit = /**
     * @param {?} error
     * @param {?} metadata
     * @return {?}
     */
    function (error, metadata) {
        this.Exit.emit({
            error: error,
            metadata: metadata
        });
    };
    /**
     * @param {?} eventName
     * @param {?} metadata
     * @return {?}
     */
    NgxPlaidLinkButtonComponent.prototype.onEvent = /**
     * @param {?} eventName
     * @param {?} metadata
     * @return {?}
     */
    function (eventName, metadata) {
        this.Event.emit({
            eventName: eventName,
            metadata: metadata
        });
    };
    /**
     * @param {?} public_token
     * @param {?} metadata
     * @return {?}
     */
    NgxPlaidLinkButtonComponent.prototype.onSuccess = /**
     * @param {?} public_token
     * @param {?} metadata
     * @return {?}
     */
    function (public_token, metadata) {
        this.Success.emit({
            token: public_token,
            metadata: metadata
        });
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    NgxPlaidLinkButtonComponent.prototype.onClick = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.Click.emit($event);
        /** @type {?} */
        var institution = this.institution || null;
        if (this.plaidLinkHandler) {
            this.plaidLinkHandler.open(institution);
        }
    };
    /**
     * @param {?=} $event
     * @return {?}
     */
    NgxPlaidLinkButtonComponent.prototype.onLoad = /**
     * @param {?=} $event
     * @return {?}
     */
    function ($event) {
        if ($event === void 0) { $event = 'link_loaded'; }
        this.Load.emit($event);
    };
    NgxPlaidLinkButtonComponent.decorators = [
        { type: Component, args: [{
                    selector: 'mr-ngx-plaid-link-button',
                    template: "\n    <button\n      (click)=\"onClick($event)\"\n      [class]=\"className\"\n      [disabled]=\"disabledButton\"\n      [ngStyle]=\"style\">\n      {{buttonText}}\n    </button>\n  ",
                    styles: []
                },] },
    ];
    /** @nocollapse */
    NgxPlaidLinkButtonComponent.ctorParameters = function () { return [
        { type: NgxPlaidLinkService }
    ]; };
    NgxPlaidLinkButtonComponent.propDecorators = {
        apiVersion: [{ type: Input }],
        clientName: [{ type: Input }],
        env: [{ type: Input }],
        institution: [{ type: Input }],
        publicKey: [{ type: Input }],
        product: [{ type: Input }],
        token: [{ type: Input }],
        webhook: [{ type: Input }],
        style: [{ type: Input }],
        className: [{ type: Input }],
        buttonText: [{ type: Input }],
        Event: [{ type: Output }],
        Click: [{ type: Output }],
        Load: [{ type: Output }],
        Exit: [{ type: Output }],
        Success: [{ type: Output }]
    };
    return NgxPlaidLinkButtonComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var NgxPlaidLinkModule = /** @class */ (function () {
    function NgxPlaidLinkModule() {
    }
    NgxPlaidLinkModule.decorators = [
        { type: NgModule, args: [{
                    imports: [
                        CommonModule
                    ],
                    providers: [
                        NgxPlaidLinkService
                    ],
                    declarations: [NgxPlaidLinkButtonComponent],
                    exports: [NgxPlaidLinkButtonComponent]
                },] },
    ];
    return NgxPlaidLinkModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */

export { NgxPlaidLinkService, NgxPlaidLinkButtonComponent, NgxPlaidLinkModule };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXBsYWlkLWxpbmsuanMubWFwIiwic291cmNlcyI6WyJuZzovL25neC1wbGFpZC1saW5rL2xpYi9uZ3gtcGxhaWQtbGluay1oYW5kbGVyLnRzIiwibmc6Ly9uZ3gtcGxhaWQtbGluay9saWIvbmd4LXBsYWlkLWxpbmsuc2VydmljZS50cyIsIm5nOi8vbmd4LXBsYWlkLWxpbmsvbGliL25neC1wbGFpZC1saW5rLWJ1dHRvbi5jb21wb25lbnQudHMiLCJuZzovL25neC1wbGFpZC1saW5rL2xpYi9uZ3gtcGxhaWQtbGluay5tb2R1bGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGxhaWRDb25maWcgfSBmcm9tICcuL2ludGVyZmFjZXMnO1xuXG5kZWNsYXJlIGxldCBQbGFpZDogYW55O1xuXG5leHBvcnQgY2xhc3MgUGxhaWRMaW5rSGFuZGxlciB7XG5cbiAgLyoqXG4gICAqIEhvbGRzIHRoZSBQbGFpZCBMaW5rIGluc3RhbmNlLlxuICAgKi9cbiAgcHJpdmF0ZSBwbGFpZExpbms6IGFueTtcblxuICAvKipcbiAgICogQ29uc3RydWN0b3IgY29uZmlndXJlcyB0aGUgUGxhaWQgTGluayBoYW5kbGVyIHdpdGggZ2l2ZW4gY29uZmlnIG9wdGlvbnMuXG4gICAqIEBwYXJhbSBQbGFpZENvbmZpZyBjb25maWdcbiAgICovXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogUGxhaWRDb25maWcpIHtcbiAgICB0aGlzLnBsYWlkTGluayA9IFBsYWlkLmNyZWF0ZShjb25maWcpO1xuICB9XG5cbiAgLyoqXG4gICAqIE9wZW4gdGhlIFBsYWlkIExpbmsgd2luZG93IGZvciB0aGlzIGhhbmRsZXIuXG4gICAqIEBwYXJhbSBzdHJpbmcgaW5zdGl0dXRpb24gVGhlIG5hbWUgb2YgdGhlIGluc3RpdHV0aW9uIHRvIG9wZW5cbiAgICovXG4gIHB1YmxpYyBvcGVuKGluc3RpdHV0aW9uPzogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5wbGFpZExpbmsub3BlbihpbnN0aXR1dGlvbik7XG4gIH1cblxuICAvKipcbiAgICogQ2xvc2VzIHRoZSBjdXJyZW50bHkgb3BlbiBQbGFpZCBMaW5rIHdpbmRvdyBpZiBhbnkuXG4gICAqL1xuICBwdWJsaWMgZXhpdCgpOiB2b2lkIHtcbiAgICB0aGlzLnBsYWlkTGluay5leGl0KCk7XG4gIH1cblxufVxuIiwiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgUGxhaWRDb25maWcgfSBmcm9tICcuL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgUGxhaWRMaW5rSGFuZGxlciB9IGZyb20gJy4vbmd4LXBsYWlkLWxpbmstaGFuZGxlcic7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBOZ3hQbGFpZExpbmtTZXJ2aWNlIHtcblxuICBwcml2YXRlIGxvYWRlZDogUHJvbWlzZTx2b2lkPjtcblxuICBjb25zdHJ1Y3RvcigpIHsgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBQbGFpZCBMaW5rIGluc3RhbmNlIGFzIHNvb24gYXMgUGxhaWQgTGluayBoYXMgbG9hZGVkLlxuICAgKiBAcGFyYW0gUGxhaWRDb25maWcgY29uZmlnXG4gICAqIEByZXR1cm5zIFByb21pc2U8UGxhaWRMaW5rSGFuZGxlcj5cbiAgICovXG4gIHB1YmxpYyBjcmVhdGVQbGFpZChjb25maWc6IFBsYWlkQ29uZmlnKTogUHJvbWlzZTxQbGFpZExpbmtIYW5kbGVyPiB7XG4gICAgcmV0dXJuIHRoaXMubG9hZFBsYWlkKCkudGhlbigoKSA9PiB7XG4gICAgICByZXR1cm4gbmV3IFBsYWlkTGlua0hhbmRsZXIoY29uZmlnKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2FkIG9yIHdhaXQgZm9yIHRoZSBQbGFpZCBMaW5rIGxpYnJhcnkgdG8gbG9hZC5cbiAgICogQHJldHVybnMgUHJvbWlzZTx2b2lkPlxuICAgKi9cbiAgcHVibGljIGxvYWRQbGFpZCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXRoaXMubG9hZGVkKSB7XG4gICAgICB0aGlzLmxvYWRlZCA9IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3Qgc2NyaXB0OiBhbnkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgICAgc2NyaXB0LnR5cGUgPSAndGV4dC9qYXZhc2NyaXB0JztcbiAgICAgICAgc2NyaXB0LnNyYyA9ICdodHRwczovL2Nkbi5wbGFpZC5jb20vbGluay92Mi9zdGFibGUvbGluay1pbml0aWFsaXplLmpzJztcbiAgICAgICAgc2NyaXB0Lm9uZXJyb3IgPSAoZTogYW55KSA9PiByZWplY3QoZSk7XG4gICAgICAgIGlmIChzY3JpcHQucmVhZHlTdGF0ZSkge1xuICAgICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAoc2NyaXB0LnJlYWR5U3RhdGUgPT09ICdsb2FkZWQnIHx8IHNjcmlwdC5yZWFkeVN0YXRlID09PSAnY29tcGxldGUnKSB7XG4gICAgICAgICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY3JpcHQub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXS5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMubG9hZGVkO1xuICB9XG5cbn1cbiIsImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBBZnRlclZpZXdJbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICBQbGFpZEVycm9yTWV0YWRhdGEsXG4gIFBsYWlkRXJyb3JPYmplY3QsXG4gIFBsYWlkRXZlbnRNZXRhZGF0YSxcbiAgUGxhaWRPbkV2ZW50QXJncyxcbiAgUGxhaWRPbkV4aXRBcmdzLFxuICBQbGFpZE9uU3VjY2Vzc0FyZ3MsXG4gIFBsYWlkU3VjY2Vzc01ldGFkYXRhLFxuICBQbGFpZENvbmZpZ1xufSBmcm9tICcuL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgTmd4UGxhaWRMaW5rU2VydmljZSB9IGZyb20gJy4vbmd4LXBsYWlkLWxpbmsuc2VydmljZSc7XG5pbXBvcnQgeyBQbGFpZExpbmtIYW5kbGVyIH0gZnJvbSAnLi9uZ3gtcGxhaWQtbGluay1oYW5kbGVyJztcblxuZXhwb3J0IGludGVyZmFjZSBJQ3VzdG9tV2luZG93IGV4dGVuZHMgV2luZG93IHtcbiAgUGxhaWQ6IHtcbiAgICBjcmVhdGU6IEZ1bmN0aW9uO1xuICB9O1xufVxuXG5mdW5jdGlvbiBnZXRXaW5kb3coKTogYW55IHtcbiAgcmV0dXJuIHdpbmRvdztcbn1cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbXItbmd4LXBsYWlkLWxpbmstYnV0dG9uJyxcbiAgdGVtcGxhdGU6IGBcbiAgICA8YnV0dG9uXG4gICAgICAoY2xpY2spPVwib25DbGljaygkZXZlbnQpXCJcbiAgICAgIFtjbGFzc109XCJjbGFzc05hbWVcIlxuICAgICAgW2Rpc2FibGVkXT1cImRpc2FibGVkQnV0dG9uXCJcbiAgICAgIFtuZ1N0eWxlXT1cInN0eWxlXCI+XG4gICAgICB7e2J1dHRvblRleHR9fVxuICAgIDwvYnV0dG9uPlxuICBgLFxuICBzdHlsZXM6IFtdXG59KVxuZXhwb3J0IGNsYXNzIE5neFBsYWlkTGlua0J1dHRvbkNvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQge1xuXG4gIHByaXZhdGUgcGxhaWRMaW5rSGFuZGxlcjogUGxhaWRMaW5rSGFuZGxlcjtcblxuICBwcml2YXRlIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBhcGlWZXJzaW9uOiAndjInLFxuICAgIGVudjogJ3NhbmRib3gnLFxuICAgIGluc3RpdHV0aW9uOiBudWxsLFxuICAgIHRva2VuOiBudWxsLFxuICAgIHN0eWxlOiB7XG4gICAgICAnYmFja2dyb3VuZC1jb2xvcic6ICcjMDA4NWU0JyxcbiAgICAgICd0cmFuc2l0aW9uLWR1cmF0aW9uJzogJzM1MG1zJyxcbiAgICAgICd0cmFuc2l0aW9uLXByb3BlcnR5JzogJ2JhY2tncm91bmQtY29sb3IsIGJveC1zaGFkb3cnLFxuICAgICAgJ3RyYW5zaXRpb24tdGltaW5nLWZ1bmN0aW9uJzogJ2Vhc2UtaW4tb3V0JyxcbiAgICAgICctd2Via2l0LWFwcGVhcmFuY2UnOiAnYnV0dG9uJyxcbiAgICAgICdib3JkZXInOiAnMCcsXG4gICAgICAnYm9yZGVyLXJhZGl1cyc6ICc0cHgnLFxuICAgICAgJ2JveC1zaGFkb3cnOiAnMCAycHggNHB4IDAgcmdiYSgwLDAsMCwwLjEpLCBpbnNldCAwIDFweCAwIDAgcmdiYSgyNTUsMjU1LDI1NSwwLjEpJyxcbiAgICAgICdjb2xvcic6ICcjZmZmJyxcbiAgICAgICdmb250LXNpemUnOiAnMjBweCcsXG4gICAgICAnaGVpZ2h0JzogJzU2cHgnLFxuICAgICAgJ291dGxpbmUnOiAnMCcsXG4gICAgICAndGV4dC1hbGlnbic6ICdjZW50ZXInLFxuICAgICAgJ3RleHQtdHJhbnNmb3JtJzogJ25vbmUnLFxuICAgICAgJ3BhZGRpbmcnOiAnMCAyZW0nLFxuICAgICAgJ2N1cnNvcic6ICdwb2ludGVyJ1xuICAgIH0sXG4gICAgYnV0dG9uVGV4dDogJ0xvZyBJbiBUbyBZb3VyIEJhbmsgQWNjb3VudCcsXG4gICAgd2ViaG9vazogJycsXG4gICAgcHJvZHVjdDogWydhdXRoJ10sXG4gICAgY2xhc3NOYW1lOiAncGxhaWQtbGluay1idXR0b24nXG4gIH07XG5cbiAgZGlzYWJsZWRCdXR0b246IGJvb2xlYW47XG5cbiAgQElucHV0KCkgYXBpVmVyc2lvbj86IHN0cmluZyA9IHRoaXMuZGVmYXVsdFByb3BzLmFwaVZlcnNpb247XG4gIEBJbnB1dCgpIGNsaWVudE5hbWU6IHN0cmluZztcbiAgQElucHV0KCkgZW52Pzogc3RyaW5nID0gdGhpcy5kZWZhdWx0UHJvcHMuZW52O1xuICBASW5wdXQoKSBpbnN0aXR1dGlvbj86IHN0cmluZyA9IHRoaXMuZGVmYXVsdFByb3BzLmluc3RpdHV0aW9uO1xuICBASW5wdXQoKSBwdWJsaWNLZXk6IHN0cmluZztcbiAgQElucHV0KCkgcHJvZHVjdD86IEFycmF5PHN0cmluZz4gPSB0aGlzLmRlZmF1bHRQcm9wcy5wcm9kdWN0O1xuICBASW5wdXQoKSB0b2tlbj86IHN0cmluZyA9IHRoaXMuZGVmYXVsdFByb3BzLnRva2VuO1xuICBASW5wdXQoKSB3ZWJob29rPzogc3RyaW5nID0gdGhpcy5kZWZhdWx0UHJvcHMud2ViaG9vaztcbiAgQElucHV0KCkgc3R5bGU/OiBhbnkgPSB0aGlzLmRlZmF1bHRQcm9wcy5zdHlsZTtcbiAgQElucHV0KCkgY2xhc3NOYW1lPzogc3RyaW5nID0gdGhpcy5kZWZhdWx0UHJvcHMuY2xhc3NOYW1lO1xuICBASW5wdXQoKSBidXR0b25UZXh0Pzogc3RyaW5nID0gdGhpcy5kZWZhdWx0UHJvcHMuYnV0dG9uVGV4dDtcblxuICBAT3V0cHV0KCkgRXZlbnQ6IEV2ZW50RW1pdHRlcjxQbGFpZE9uRXZlbnRBcmdzPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgQE91dHB1dCgpIENsaWNrOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgQE91dHB1dCgpIExvYWQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBAT3V0cHV0KCkgRXhpdDogRXZlbnRFbWl0dGVyPFBsYWlkT25FeGl0QXJncz4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBPdXRwdXQoKSBTdWNjZXNzOiBFdmVudEVtaXR0ZXI8UGxhaWRPblN1Y2Nlc3NBcmdzPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICBnZXQgbmF0aXZlV2luZG93KCk6IElDdXN0b21XaW5kb3cge1xuICAgIHJldHVybiBnZXRXaW5kb3coKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcGxhaWRMaW5rTG9hZGVyOiBOZ3hQbGFpZExpbmtTZXJ2aWNlKSB7XG4gICAgdGhpcy5kaXNhYmxlZEJ1dHRvbiA9IHRydWU7XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5wbGFpZExpbmtMb2FkZXIuY3JlYXRlUGxhaWQoe1xuICAgICAgZW52OiBzZWxmLmVudixcbiAgICAgIGtleTogc2VsZi5wdWJsaWNLZXksXG4gICAgICBwcm9kdWN0OiBzZWxmLnByb2R1Y3QsXG4gICAgICBhcGlWZXJzaW9uOiAndjInLFxuICAgICAgY2xpZW50TmFtZTogc2VsZi5jbGllbnROYW1lLFxuICAgICAgb25TdWNjZXNzOiBmdW5jdGlvbiAocHVibGljX3Rva2VuLCBtZXRhZGF0YSkge1xuICAgICAgICBzZWxmLm9uU3VjY2VzcyhwdWJsaWNfdG9rZW4sIG1ldGFkYXRhKTtcbiAgICAgIH0sXG4gICAgICBvbkV4aXQ6IGZ1bmN0aW9uIChlcnIsIG1ldGFkYXRhKSB7XG4gICAgICAgIHNlbGYub25FeGl0KGVyciwgbWV0YWRhdGEpO1xuICAgICAgfSxcbiAgICAgIG9uRXZlbnQ6IGZ1bmN0aW9uIChldmVudE5hbWUsIG1ldGFkYXRhKSB7XG4gICAgICAgIHNlbGYub25FdmVudChldmVudE5hbWUsIG1ldGFkYXRhKTtcbiAgICAgIH0sXG4gICAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2VsZi5vbkxvYWQoKTtcbiAgICAgIH0sXG4gICAgICB0b2tlbjogc2VsZi50b2tlbiB8fCBudWxsLFxuICAgICAgd2ViaG9vazogc2VsZi53ZWJob29rIHx8IG51bGxcbiAgICB9KS50aGVuKChoYW5kbGVyOiBQbGFpZExpbmtIYW5kbGVyKSA9PiB7XG4gICAgICB0aGlzLmRpc2FibGVkQnV0dG9uID0gZmFsc2U7XG4gICAgICB0aGlzLnBsYWlkTGlua0hhbmRsZXIgPSBoYW5kbGVyO1xuICAgIH0pO1xuICB9XG5cbiAgb25TY3JpcHRFcnJvcigpIHtcbiAgICBjb25zb2xlLmVycm9yKCdUaGVyZSB3YXMgYW4gaXNzdWUgbG9hZGluZyB0aGUgbGluay1pbml0aWFsaXplLmpzIHNjcmlwdCcpO1xuICB9XG5cbiAgcHVibGljIG9uRXhpdChlcnJvcjogUGxhaWRFcnJvck9iamVjdCwgbWV0YWRhdGE6IFBsYWlkRXJyb3JNZXRhZGF0YSkge1xuICAgIHRoaXMuRXhpdC5lbWl0KHtcbiAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgIG1ldGFkYXRhOiBtZXRhZGF0YVxuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIG9uRXZlbnQoZXZlbnROYW1lOiBzdHJpbmcsIG1ldGFkYXRhOiBQbGFpZEV2ZW50TWV0YWRhdGEpIHtcbiAgICB0aGlzLkV2ZW50LmVtaXQoe1xuICAgICAgZXZlbnROYW1lOiBldmVudE5hbWUsXG4gICAgICBtZXRhZGF0YTogbWV0YWRhdGFcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBvblN1Y2Nlc3MocHVibGljX3Rva2VuOiBzdHJpbmcsIG1ldGFkYXRhOiBQbGFpZFN1Y2Nlc3NNZXRhZGF0YSkge1xuICAgIHRoaXMuU3VjY2Vzcy5lbWl0KHtcbiAgICAgIHRva2VuOiBwdWJsaWNfdG9rZW4sXG4gICAgICBtZXRhZGF0YTogbWV0YWRhdGFcbiAgICB9KTtcbiAgfVxuXG4gIG9uQ2xpY2soJGV2ZW50KSB7XG4gICAgdGhpcy5DbGljay5lbWl0KCRldmVudCk7XG4gICAgLy8gT3BlbiB0byBhIHNwZWNpZmljIGluc3RpdHV0aW9uIGlmIG5lY2Vzc2FyeTtcbiAgICBjb25zdCBpbnN0aXR1dGlvbiA9IHRoaXMuaW5zdGl0dXRpb24gfHwgbnVsbDtcbiAgICBpZiAodGhpcy5wbGFpZExpbmtIYW5kbGVyKSB7XG4gICAgICB0aGlzLnBsYWlkTGlua0hhbmRsZXIub3BlbihpbnN0aXR1dGlvbik7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIG9uTG9hZCgkZXZlbnQgPSAnbGlua19sb2FkZWQnKSB7XG4gICAgdGhpcy5Mb2FkLmVtaXQoJGV2ZW50KTtcbiAgfVxuXG59XG4iLCJpbXBvcnQgeyBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7IE5neFBsYWlkTGlua0J1dHRvbkNvbXBvbmVudCB9IGZyb20gJy4vbmd4LXBsYWlkLWxpbmstYnV0dG9uLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBOZ3hQbGFpZExpbmtTZXJ2aWNlIH0gZnJvbSAnLi9uZ3gtcGxhaWQtbGluay5zZXJ2aWNlJztcblxuQE5nTW9kdWxlKHtcbiAgaW1wb3J0czogW1xuICAgIENvbW1vbk1vZHVsZVxuICBdLFxuICBwcm92aWRlcnM6IFtcbiAgICBOZ3hQbGFpZExpbmtTZXJ2aWNlXG4gIF0sXG4gIGRlY2xhcmF0aW9uczogW05neFBsYWlkTGlua0J1dHRvbkNvbXBvbmVudF0sXG4gIGV4cG9ydHM6IFtOZ3hQbGFpZExpbmtCdXR0b25Db21wb25lbnRdXG59KVxuZXhwb3J0IGNsYXNzIE5neFBsYWlkTGlua01vZHVsZSB7IH1cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBSUEsSUFBQTs7Ozs7SUFXRSwwQkFBWSxNQUFtQjtRQUM3QixJQUFJLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7S0FDdkM7Ozs7OztJQU1NLCtCQUFJOzs7OztjQUFDLFdBQW9CO1FBQzlCLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDOzs7Ozs7SUFNNUIsK0JBQUk7Ozs7O1FBQ1QsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsQ0FBQzs7MkJBL0IxQjtJQWtDQyxDQUFBOzs7Ozs7QUNsQ0Q7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