/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter } from '@angular/core';
import { NgxPlaidLinkService } from './ngx-plaid-link.service';
/**
 * @record
 */
export function ICustomWindow() { }
/** @type {?} */
ICustomWindow.prototype.Plaid;
/**
 * @return {?}
 */
function getWindow() {
    return window;
}
export class NgxPlaidLinkButtonComponent {
    /**
     * @param {?} plaidLinkLoader
     */
    constructor(plaidLinkLoader) {
        this.plaidLinkLoader = plaidLinkLoader;
        this.defaultProps = {
            apiVersion: 'v2',
            env: 'sandbox',
            institution: null,
            token: null,
            style: {
                'background-color': '#0085e4',
                'transition-duration': '350ms',
                'transition-property': 'background-color, box-shadow',
                'transition-timing-function': 'ease-in-out',
                '-webkit-appearance': 'button',
                'border': '0',
                'border-radius': '4px',
                'box-shadow': '0 2px 4px 0 rgba(0,0,0,0.1), inset 0 1px 0 0 rgba(255,255,255,0.1)',
                'color': '#fff',
                'font-size': '20px',
                'height': '56px',
                'outline': '0',
                'text-align': 'center',
                'text-transform': 'none',
                'padding': '0 2em',
                'cursor': 'pointer'
            },
            buttonText: 'Log In To Your Bank Account',
            webhook: '',
            product: ['auth'],
            className: 'plaid-link-button'
        };
        this.apiVersion = this.defaultProps.apiVersion;
        this.env = this.defaultProps.env;
        this.institution = this.defaultProps.institution;
        this.product = this.defaultProps.product;
        this.token = this.defaultProps.token;
        this.webhook = this.defaultProps.webhook;
        this.style = this.defaultProps.style;
        this.className = this.defaultProps.className;
        this.buttonText = this.defaultProps.buttonText;
        this.Event = new EventEmitter();
        this.Click = new EventEmitter();
        this.Load = new EventEmitter();
        this.Exit = new EventEmitter();
        this.Success = new EventEmitter();
        this.disabledButton = true;
    }
    /**
     * @return {?}
     */
    get nativeWindow() {
        return getWindow();
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        /** @type {?} */
        const self = this;
        this.plaidLinkLoader.createPlaid({
            env: self.env,
            key: self.publicKey,
            product: self.product,
            apiVersion: 'v2',
            clientName: self.clientName,
            onSuccess: function (public_token, metadata) {
                self.onSuccess(public_token, metadata);
            },
            onExit: function (err, metadata) {
                self.onExit(err, metadata);
            },
            onEvent: function (eventName, metadata) {
                self.onEvent(eventName, metadata);
            },
            onLoad: function () {
                self.onLoad();
            },
            token: self.token || null,
            webhook: self.webhook || null
        }).then((handler) => {
            this.disabledButton = false;
            this.plaidLinkHandler = handler;
        });
    }
    /**
     * @return {?}
     */
    onScriptError() {
        console.error('There was an issue loading the link-initialize.js script');
    }
    /**
     * @param {?} error
     * @param {?} metadata
     * @return {?}
     */
    onExit(error, metadata) {
        this.Exit.emit({
            error: error,
            metadata: metadata
        });
    }
    /**
     * @param {?} eventName
     * @param {?} metadata
     * @return {?}
     */
    onEvent(eventName, metadata) {
        this.Event.emit({
            eventName: eventName,
            metadata: metadata
        });
    }
    /**
     * @param {?} public_token
     * @param {?} metadata
     * @return {?}
     */
    onSuccess(public_token, metadata) {
        this.Success.emit({
            token: public_token,
            metadata: metadata
        });
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onClick($event) {
        this.Click.emit($event);
        /** @type {?} */
        const institution = this.institution || null;
        if (this.plaidLinkHandler) {
            this.plaidLinkHandler.open(institution);
        }
    }
    /**
     * @param {?=} $event
     * @return {?}
     */
    onLoad($event = 'link_loaded') {
        this.Load.emit($event);
    }
}
NgxPlaidLinkButtonComponent.decorators = [
    { type: Component, args: [{
                selector: 'mr-ngx-plaid-link-button',
                template: `
    <button
      (click)="onClick($event)"
      [class]="className"
      [disabled]="disabledButton"
      [ngStyle]="style">
      {{buttonText}}
    </button>
  `,
                styles: []
            },] },
];
/** @nocollapse */
NgxPlaidLinkButtonComponent.ctorParameters = () => [
    { type: NgxPlaidLinkService }
];
NgxPlaidLinkButtonComponent.propDecorators = {
    apiVersion: [{ type: Input }],
    clientName: [{ type: Input }],
    env: [{ type: Input }],
    institution: [{ type: Input }],
    publicKey: [{ type: Input }],
    product: [{ type: Input }],
    token: [{ type: Input }],
    webhook: [{ type: Input }],
    style: [{ type: Input }],
    className: [{ type: Input }],
    buttonText: [{ type: Input }],
    Event: [{ type: Output }],
    Click: [{ type: Output }],
    Load: [{ type: Output }],
    Exit: [{ type: Output }],
    Success: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.plaidLinkHandler;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.defaultProps;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.disabledButton;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.apiVersion;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.clientName;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.env;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.institution;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.publicKey;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.product;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.token;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.webhook;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.style;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.className;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.buttonText;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.Event;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.Click;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.Load;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.Exit;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.Success;
    /** @type {?} */
    NgxPlaidLinkButtonComponent.prototype.plaidLinkLoader;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXBsYWlkLWxpbmstYnV0dG9uLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1wbGFpZC1saW5rLyIsInNvdXJjZXMiOlsibGliL25neC1wbGFpZC1saW5rLWJ1dHRvbi5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQWlCLE1BQU0sZUFBZSxDQUFDO0FBV3RGLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDOzs7Ozs7Ozs7O0FBUy9EO0lBQ0UsTUFBTSxDQUFDLE1BQU0sQ0FBQztDQUNmO0FBZUQsTUFBTTs7OztJQXlESixZQUFvQixlQUFvQztRQUFwQyxvQkFBZSxHQUFmLGVBQWUsQ0FBcUI7NEJBckRqQztZQUNyQixVQUFVLEVBQUUsSUFBSTtZQUNoQixHQUFHLEVBQUUsU0FBUztZQUNkLFdBQVcsRUFBRSxJQUFJO1lBQ2pCLEtBQUssRUFBRSxJQUFJO1lBQ1gsS0FBSyxFQUFFO2dCQUNMLGtCQUFrQixFQUFFLFNBQVM7Z0JBQzdCLHFCQUFxQixFQUFFLE9BQU87Z0JBQzlCLHFCQUFxQixFQUFFLDhCQUE4QjtnQkFDckQsNEJBQTRCLEVBQUUsYUFBYTtnQkFDM0Msb0JBQW9CLEVBQUUsUUFBUTtnQkFDOUIsUUFBUSxFQUFFLEdBQUc7Z0JBQ2IsZUFBZSxFQUFFLEtBQUs7Z0JBQ3RCLFlBQVksRUFBRSxvRUFBb0U7Z0JBQ2xGLE9BQU8sRUFBRSxNQUFNO2dCQUNmLFdBQVcsRUFBRSxNQUFNO2dCQUNuQixRQUFRLEVBQUUsTUFBTTtnQkFDaEIsU0FBUyxFQUFFLEdBQUc7Z0JBQ2QsWUFBWSxFQUFFLFFBQVE7Z0JBQ3RCLGdCQUFnQixFQUFFLE1BQU07Z0JBQ3hCLFNBQVMsRUFBRSxPQUFPO2dCQUNsQixRQUFRLEVBQUUsU0FBUzthQUNwQjtZQUNELFVBQVUsRUFBRSw2QkFBNkI7WUFDekMsT0FB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TCxPQUFPLENBQUMsTUFBTTtRQUNaLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDOztRQUV4QixNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsV0FBVyxJQUFJLElBQUksQ0FBQztRQUM3QyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDO1lBQzFCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDekM7S0FDRjs7Ozs7SUFFTSxNQUFNLENBQUMsTUFBTSxHQUFHLGFBQWE7UUFDbEMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7Ozs7WUF6STFCLFNBQVMsU0FBQztnQkFDVCxRQUFRLEVBQUUsMEJBQTBCO2dCQUNwQyxRQUFRLEVBQUU7Ozs7Ozs7O0dBUVQ7Z0JBQ0QsTUFBTSxFQUFFLEVBQUU7YUFDWDs7OztZQXpCUSxtQkFBbUI7Ozt5QkE2RHpCLEtBQUs7eUJBQ0wsS0FBSztrQkFDTCxLQUFLOzBCQUNMLEtBQUs7d0JBQ0wsS0FBSztzQkFDTCxLQUFLO29CQUNMLEtBQUs7c0JBQ0wsS0FBSztvQkFDTCxLQUFLO3dCQUNMLEtBQUs7eUJBQ0wsS0FBSztvQkFFTCxNQUFNO29CQUNOLE1BQU07bUJBQ04sTUFBTTttQkFDTixNQUFNO3NCQUNOLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgQWZ0ZXJWaWV3SW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtcbiAgUGxhaWRFcnJvck1ldGFkYXRhLFxuICBQbGFpZEVycm9yT2JqZWN0LFxuICBQbGFpZEV2ZW50TWV0YWRhdGEsXG4gIFBsYWlkT25FdmVudEFyZ3MsXG4gIFBsYWlkT25FeGl0QXJncyxcbiAgUGxhaWRPblN1Y2Nlc3NBcmdzLFxuICBQbGFpZFN1Y2Nlc3NNZXRhZGF0YSxcbiAgUGxhaWRDb25maWdcbn0gZnJvbSAnLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7IE5neFBsYWlkTGlua1NlcnZpY2UgfSBmcm9tICcuL25neC1wbGFpZC1saW5rLnNlcnZpY2UnO1xuaW1wb3J0IHsgUGxhaWRMaW5rSGFuZGxlciB9IGZyb20gJy4vbmd4LXBsYWlkLWxpbmstaGFuZGxlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUN1c3RvbVdpbmRvdyBleHRlbmRzIFdpbmRvdyB7XG4gIFBsYWlkOiB7XG4gICAgY3JlYXRlOiBGdW5jdGlvbjtcbiAgfTtcbn1cblxuZnVuY3Rpb24gZ2V0V2luZG93KCk6IGFueSB7XG4gIHJldHVybiB3aW5kb3c7XG59XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ21yLW5neC1wbGFpZC1saW5rLWJ1dHRvbicsXG4gIHRlbXBsYXRlOiBgXG4gICAgPGJ1dHRvblxuICAgICAgKGNsaWNrKT1cIm9uQ2xpY2soJGV2ZW50KVwiXG4gICAgICBbY2xhc3NdPVwiY2xhc3NOYW1lXCJcbiAgICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZEJ1dHRvblwiXG4gICAgICBbbmdTdHlsZV09XCJzdHlsZVwiPlxuICAgICAge3tidXR0b25UZXh0fX1cbiAgICA8L2J1dHRvbj5cbiAgYCxcbiAgc3R5bGVzOiBbXVxufSlcbmV4cG9ydCBjbGFzcyBOZ3hQbGFpZExpbmtCdXR0b25Db21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0IHtcblxuICBwcml2YXRlIHBsYWlkTGlua0hhbmRsZXI6IFBsYWlkTGlua0hhbmRsZXI7XG5cbiAgcHJpdmF0ZSBkZWZhdWx0UHJvcHMgPSB7XG4gICAgYXBpVmVyc2lvbjogJ3YyJyxcbiAgICBlbnY6ICdzYW5kYm94JyxcbiAgICBpbnN0aXR1dGlvbjogbnVsbCxcbiAgICB0b2tlbjogbnVsbCxcbiAgICBzdHlsZToge1xuICAgICAgJ2JhY2tncm91bmQtY29sb3InOiAnIzAwODVlNCcsXG4gICAgICAndHJhbnNpdGlvbi1kdXJhdGlvbic6ICczNTBtcycsXG4gICAgICAndHJhbnNpdGlvbi1wcm9wZXJ0eSc6ICdiYWNrZ3JvdW5kLWNvbG9yLCBib3gtc2hhZG93JyxcbiAgICAgICd0cmFuc2l0aW9uLXRpbWluZy1mdW5jdGlvbic6ICdlYXNlLWluLW91dCcsXG4gICAgICAnLXdlYmtpdC1hcHBlYXJhbmNlJzogJ2J1dHRvbicsXG4gICAgICAnYm9yZGVyJzogJzAnLFxuICAgICAgJ2JvcmRlci1yYWRpdXMnOiAnNHB4JyxcbiAgICAgICdib3gtc2hhZG93JzogJzAgMnB4IDRweCAwIHJnYmEoMCwwLDAsMC4xKSwgaW5zZXQgMCAxcHggMCAwIHJnYmEoMjU1LDI1NSwyNTUsMC4xKScsXG4gICAgICAnY29sb3InOiAnI2ZmZicsXG4gICAgICAnZm9udC1zaXplJzogJzIwcHgnLFxuICAgICAgJ2hlaWdodCc6ICc1NnB4JyxcbiAgICAgICdvdXRsaW5lJzogJzAnLFxuICAgICAgJ3RleHQtYWxpZ24nOiAnY2VudGVyJyxcbiAgICAgICd0ZXh0LXRyYW5zZm9ybSc6ICdub25lJyxcbiAgICAgICdwYWRkaW5nJzogJzAgMmVtJyxcbiAgICAgICdjdXJzb3InOiAncG9pbnRlcidcbiAgICB9LFxuICAgIGJ1dHRvblRleHQ6ICdMb2cgSW4gVG8gWW91ciBCYW5rIEFjY291bnQnLFxuICAgIHdlYmhvb2s6ICcnLFxuICAgIHByb2R1Y3Q6IFsnYXV0aCddLFxuICAgIGNsYXNzTmFtZTogJ3BsYWlkLWxpbmstYnV0dG9uJ1xuICB9O1xuXG4gIGRpc2FibGVkQnV0dG9uOiBib29sZWFuO1xuXG4gIEBJbnB1dCgpIGFwaVZlcnNpb24/OiBzdHJpbmcgPSB0aGlzLmRlZmF1bHRQcm9wcy5hcGlWZXJzaW9uO1xuICBASW5wdXQoKSBjbGllbnROYW1lOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGVudj86IHN0cmluZyA9IHRoaXMuZGVmYXVsdFByb3BzLmVudjtcbiAgQElucHV0KCkgaW5zdGl0dXRpb24/OiBzdHJpbmcgPSB0aGlzLmRlZmF1bHRQcm9wcy5pbnN0aXR1dGlvbjtcbiAgQElucHV0KCkgcHVibGljS2V5OiBzdHJpbmc7XG4gIEBJbnB1dCgpIHByb2R1Y3Q/OiBBcnJheTxzdHJpbmc+ID0gdGhpcy5kZWZhdWx0UHJvcHMucHJvZHVjdDtcbiAgQElucHV0KCkgdG9rZW4/OiBzdHJpbmcgPSB0aGlzLmRlZmF1bHRQcm9wcy50b2tlbjtcbiAgQElucHV0KCkgd2ViaG9vaz86IHN0cmluZyA9IHRoaXMuZGVmYXVsdFByb3BzLndlYmhvb2s7XG4gIEBJbnB1dCgpIHN0eWxlPzogYW55ID0gdGhpcy5kZWZhdWx0UHJvcHMuc3R5bGU7XG4gIEBJbnB1dCgpIGNsYXNzTmFtZT86IHN0cmluZyA9IHRoaXMuZGVmYXVsdFByb3BzLmNsYXNzTmFtZTtcbiAgQElucHV0KCkgYnV0dG9uVGV4dD86IHN0cmluZyA9IHRoaXMuZGVmYXVsdFByb3BzLmJ1dHRvblRleHQ7XG5cbiAgQE91dHB1dCgpIEV2ZW50OiBFdmVudEVtaXR0ZXI8UGxhaWRPbkV2ZW50QXJncz4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBPdXRwdXQoKSBDbGljazogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBPdXRwdXQoKSBMb2FkOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgQE91dHB1dCgpIEV4aXQ6IEV2ZW50RW1pdHRlcjxQbGFpZE9uRXhpdEFyZ3M+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBAT3V0cHV0KCkgU3VjY2VzczogRXZlbnRFbWl0dGVyPFBsYWlkT25TdWNjZXNzQXJncz4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgZ2V0IG5hdGl2ZVdpbmRvdygpOiBJQ3VzdG9tV2luZG93IHtcbiAgICByZXR1cm4gZ2V0V2luZG93KCk7XG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHBsYWlkTGlua0xvYWRlcjogTmd4UGxhaWRMaW5rU2VydmljZSkge1xuICAgIHRoaXMuZGlzYWJsZWRCdXR0b24gPSB0cnVlO1xuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuICAgIHRoaXMucGxhaWRMaW5rTG9hZGVyLmNyZWF0ZVBsYWlkKHtcbiAgICAgIGVudjogc2VsZi5lbnYsXG4gICAgICBrZXk6IHNlbGYucHVibGljS2V5LFxuICAgICAgcHJvZHVjdDogc2VsZi5wcm9kdWN0LFxuICAgICAgYXBpVmVyc2lvbjogJ3YyJyxcbiAgICAgIGNsaWVudE5hbWU6IHNlbGYuY2xpZW50TmFtZSxcbiAgICAgIG9uU3VjY2VzczogZnVuY3Rpb24gKHB1YmxpY190b2tlbiwgbWV0YWRhdGEpIHtcbiAgICAgICAgc2VsZi5vblN1Y2Nlc3MocHVibGljX3Rva2VuLCBtZXRhZGF0YSk7XG4gICAgICB9LFxuICAgICAgb25FeGl0OiBmdW5jdGlvbiAoZXJyLCBtZXRhZGF0YSkge1xuICAgICAgICBzZWxmLm9uRXhpdChlcnIsIG1ldGFkYXRhKTtcbiAgICAgIH0sXG4gICAgICBvbkV2ZW50OiBmdW5jdGlvbiAoZXZlbnROYW1lLCBtZXRhZGF0YSkge1xuICAgICAgICBzZWxmLm9uRXZlbnQoZXZlbnROYW1lLCBtZXRhZGF0YSk7XG4gICAgICB9LFxuICAgICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNlbGYub25Mb2FkKCk7XG4gICAgICB9LFxuICAgICAgdG9rZW46IHNlbGYudG9rZW4gfHwgbnVsbCxcbiAgICAgIHdlYmhvb2s6IHNlbGYud2ViaG9vayB8fCBudWxsXG4gICAgfSkudGhlbigoaGFuZGxlcjogUGxhaWRMaW5rSGFuZGxlcikgPT4ge1xuICAgICAgdGhpcy5kaXNhYmxlZEJ1dHRvbiA9IGZhbHNlO1xuICAgICAgdGhpcy5wbGFpZExpbmtIYW5kbGVyID0gaGFuZGxlcjtcbiAgICB9KTtcbiAgfVxuXG4gIG9uU2NyaXB0RXJyb3IoKSB7XG4gICAgY29uc29sZS5lcnJvcignVGhlcmUgd2FzIGFuIGlzc3VlIGxvYWRpbmcgdGhlIGxpbmstaW5pdGlhbGl6ZS5qcyBzY3JpcHQnKTtcbiAgfVxuXG4gIHB1YmxpYyBvbkV4aXQoZXJyb3I6IFBsYWlkRXJyb3JPYmplY3QsIG1ldGFkYXRhOiBQbGFpZEVycm9yTWV0YWRhdGEpIHtcbiAgICB0aGlzLkV4aXQuZW1pdCh7XG4gICAgICBlcnJvcjogZXJyb3IsXG4gICAgICBtZXRhZGF0YTogbWV0YWRhdGFcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBvbkV2ZW50KGV2ZW50TmFtZTogc3RyaW5nLCBtZXRhZGF0YTogUGxhaWRFdmVudE1ldGFkYXRhKSB7XG4gICAgdGhpcy5FdmVudC5lbWl0KHtcbiAgICAgIGV2ZW50TmFtZTogZXZlbnROYW1lLFxuICAgICAgbWV0YWRhdGE6IG1ldGFkYXRhXG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgb25TdWNjZXNzKHB1YmxpY190b2tlbjogc3RyaW5nLCBtZXRhZGF0YTogUGxhaWRTdWNjZXNzTWV0YWRhdGEpIHtcbiAgICB0aGlzLlN1Y2Nlc3MuZW1pdCh7XG4gICAgICB0b2tlbjogcHVibGljX3Rva2VuLFxuICAgICAgbWV0YWRhdGE6IG1ldGFkYXRhXG4gICAgfSk7XG4gIH1cblxuICBvbkNsaWNrKCRldmVudCkge1xuICAgIHRoaXMuQ2xpY2suZW1pdCgkZXZlbnQpO1xuICAgIC8vIE9wZW4gdG8gYSBzcGVjaWZpYyBpbnN0aXR1dGlvbiBpZiBuZWNlc3Nhcnk7XG4gICAgY29uc3QgaW5zdGl0dXRpb24gPSB0aGlzLmluc3RpdHV0aW9uIHx8IG51bGw7XG4gICAgaWYgKHRoaXMucGxhaWRMaW5rSGFuZGxlcikge1xuICAgICAgdGhpcy5wbGFpZExpbmtIYW5kbGVyLm9wZW4oaW5zdGl0dXRpb24pO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBvbkxvYWQoJGV2ZW50ID0gJ2xpbmtfbG9hZGVkJykge1xuICAgIHRoaXMuTG9hZC5lbWl0KCRldmVudCk7XG4gIH1cblxufVxuIl19