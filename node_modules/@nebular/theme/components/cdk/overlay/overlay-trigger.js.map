{"version":3,"file":"overlay-trigger.js","sourceRoot":"","sources":["../../../../../../.ng_build/theme/components/cdk/overlay/overlay-trigger.ts"],"names":[],"mappings":"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","sourcesContent":["import { fromEvent as observableFromEvent, merge as observableMerge, Observable, Subject } from 'rxjs';\nimport { debounceTime, delay, filter, repeat, switchMap, takeUntil, takeWhile } from 'rxjs/operators';\nimport { ComponentRef } from '@angular/core';\n\n\nexport enum NbTrigger {\n  CLICK = 'click',\n  HOVER = 'hover',\n  HINT = 'hint',\n  FOCUS = 'focus',\n}\n\n/**\n * Provides entity with two event stream: show and hide.\n * Each stream provides different events depends on implementation.\n * We have three main trigger strategies: click, hint and hover.\n * */\n/**\n * TODO maybe we have to use renderer.listen instead of observableFromEvent?\n * Renderer provides capability use it in service worker, ssr and so on.\n * */\nexport abstract class NbTriggerStrategy {\n  abstract show$: Observable<Event>;\n  abstract hide$: Observable<Event>;\n\n  constructor(protected document: Document, protected host: HTMLElement, protected container: () => ComponentRef<any>) {\n  }\n}\n\n/**\n * Creates show and hide event streams.\n * Fires toggle event when the click was performed on the host element.\n * Fires close event when the click was performed on the document but\n * not on the host or container.\n * */\nexport class NbClickTriggerStrategy extends NbTriggerStrategy {\n  protected show: Subject<Event> = new Subject();\n  readonly show$: Observable<Event> = this.show.asObservable();\n\n  protected hide: Subject<Event> = new Subject();\n  readonly hide$: Observable<Event> = observableMerge(\n    this.hide.asObservable(),\n    observableFromEvent<Event>(this.document, 'click')\n      .pipe(filter((event: Event) => this.isNotHostOrContainer(event))),\n  );\n\n  constructor(protected document: Document, protected host: HTMLElement, protected container: () => ComponentRef<any>) {\n    super(document, host, container);\n    this.subscribeOnHostClick();\n  }\n\n  protected subscribeOnHostClick() {\n    observableFromEvent(this.host, 'click')\n      .subscribe((event: Event) => {\n        if (this.isContainerExists()) {\n          this.hide.next(event);\n        } else {\n          this.show.next(event);\n        }\n      })\n  }\n\n  protected isContainerExists(): boolean {\n    return !!this.container();\n  }\n\n  protected isNotHostOrContainer(event: Event): boolean {\n    return !this.host.contains(event.target as Node)\n      && this.isContainerExists()\n      && !this.container().location.nativeElement.contains(event.target as Node);\n  }\n}\n\n/**\n * Creates show and hide event streams.\n * Fires open event when a mouse hovers over the host element and stay over at least 100 milliseconds.\n * Fires close event when the mouse leaves the host element and stops out of the host and popover container.\n * */\nexport class NbHoverTriggerStrategy extends NbTriggerStrategy {\n\n  show$: Observable<Event> = observableFromEvent<Event>(this.host, 'mouseenter')\n    .pipe(\n      delay(100),\n      takeUntil(observableFromEvent(this.host, 'mouseleave')),\n      repeat(),\n    );\n\n  hide$: Observable<Event> = observableFromEvent<Event>(this.host, 'mouseleave')\n    .pipe(\n      switchMap(() => observableFromEvent<Event>(this.document, 'mousemove')\n        .pipe(\n          debounceTime(100),\n          takeWhile(() => !!this.container()),\n          filter(event => !this.host.contains(event.target as Node)\n            && !this.container().location.nativeElement.contains(event.target as Node),\n          ),\n        ),\n      ),\n    );\n}\n\n/**\n * Creates show and hide event streams.\n * Fires open event when a mouse hovers over the host element and stay over at least 100 milliseconds.\n * Fires close event when the mouse leaves the host element.\n * */\nexport class NbHintTriggerStrategy extends NbTriggerStrategy {\n  show$: Observable<Event> = observableFromEvent<Event>(this.host, 'mouseenter')\n    .pipe(\n      delay(100),\n      takeUntil(observableFromEvent(this.host, 'mouseleave')),\n      repeat(),\n    );\n\n  hide$: Observable<Event> = observableFromEvent(this.host, 'mouseleave');\n}\n\n\n/**\n * Creates show and hide event streams.\n * Fires open event when a focus is on the host element and stay over at least 100 milliseconds.\n * Fires close event when the focus leaves the host element.\n * */\nexport class NbFocusTriggerStrategy extends NbTriggerStrategy {\n\n  protected isNotOnHostOrContainer(event: Event): boolean {\n    return !this.isOnHost(event) && !this.isOnContainer(event);\n  }\n\n  protected isOnHost({ target }: Event): boolean {\n    return this.host.contains(target as Node);\n  }\n\n  protected isOnContainer({ target }: Event): boolean {\n    return this.container() && this.container().location.nativeElement.contains(target);\n  }\n\n  protected focusOut$: Observable<Event> = observableFromEvent<Event>(this.host, 'focusout')\n    .pipe(\n      switchMap(() => observableFromEvent<Event>(this.document, 'focusin')\n        .pipe(\n          takeWhile(() => !!this.container()),\n          filter(event => this.isNotOnHostOrContainer(event)),\n        ),\n      ),\n    );\n\n  protected clickIn$: Observable<Event> = observableFromEvent<Event>(this.host, 'click')\n    .pipe(\n      filter(() => !this.container()),\n    );\n\n  protected clickOut$: Observable<Event> = observableFromEvent<Event>(this.document, 'click')\n    .pipe(\n      filter(() => !!this.container()),\n      filter(event => this.isNotOnHostOrContainer(event)),\n    );\n\n  protected tabKeyPress$: Observable<Event> = observableFromEvent<Event>(this.document, 'keydown')\n    .pipe(\n      filter((event: KeyboardEvent) => event.keyCode === 9),\n      filter(() => !!this.container()),\n    );\n\n  show$: Observable<Event> = observableMerge(observableFromEvent<Event>(this.host, 'focusin'), this.clickIn$)\n    .pipe(\n      filter(() => !this.container()),\n      debounceTime(100),\n      takeUntil(observableFromEvent(this.host, 'focusout')),\n      repeat(),\n    );\n\n  hide$ = observableMerge(this.focusOut$, this.tabKeyPress$, this.clickOut$);\n}\n\nexport class NbTriggerStrategyBuilder {\n  protected _host: HTMLElement;\n  protected _container: () => ComponentRef<any>;\n  protected _trigger: NbTrigger;\n  protected _document: Document;\n\n  document(document: Document): this {\n    this._document = document;\n    return this;\n  }\n\n  trigger(trigger: NbTrigger): this {\n    this._trigger = trigger;\n    return this;\n  }\n\n  host(host: HTMLElement): this {\n    this._host = host;\n    return this;\n  }\n\n  container(container: () => ComponentRef<any>): this {\n    this._container = container;\n    return this;\n  }\n\n  build(): NbTriggerStrategy {\n    switch (this._trigger) {\n      case NbTrigger.CLICK:\n        return new NbClickTriggerStrategy(this._document, this._host, this._container);\n      case NbTrigger.HINT:\n        return new NbHintTriggerStrategy(this._document, this._host, this._container);\n      case NbTrigger.HOVER:\n        return new NbHoverTriggerStrategy(this._document, this._host, this._container);\n      case NbTrigger.FOCUS:\n        return new NbFocusTriggerStrategy(this._document, this._host, this._container);\n      default:\n        throw new Error('Trigger have to be provided');\n    }\n  }\n}\n"]}